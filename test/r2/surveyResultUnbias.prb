// skipped
// TODO

def maing(){
    population := readCSV("data/survey/population.csv");
    gender := readCSV("data/survey/gender.csv");
    personGender := readCSV("data/survey/personGender.csv");
    dataAnswer := readCSV("data/survey/answer.csv");
    // Vector<double> vv = Normal.Sample(0, 0, 1); // what is this?
    bias := array(population.length);
    for i in [0..population.length){
        bias[i] = Beta(1,1);
    }

    mean := array(population.length);
    for i in [0..population.length){
        mean[i] = population[i]*bias[i];
    }

    variance := array(population.length);
    for i in [0..population.length){
        variance[i] = mean[i]-mean[i]*bias[i];
    }

    votes := array(population.length);
    for i in [0..population.length){
        votes[i] = Gauss(mean[i],variance[i]);
    }

    ansBias := array(personGender.length);    
    for i in [0..personGender.length){
        ansBias[i] = bias[personGender[i]];
    }

    answer := array(ansBias.length);
    for i in [0..ansBias.length){
        answer[i] = Bernoulli(ansBias[i]);
    }
    for i in [0..ansBias.length){
        observe(answer[i]==dataAnswer[i]);
    }
    // return (bias,mean,variance,votes); // TODO
    assert(bias.length==2&&mean.length==2&&variance.length==2&&votes.length==2);
    return (bias[0],bias[1],mean[0],mean[1],variance[0],variance[1],votes[0],votes[1]);
    //return Expectation(bias[0]);
}
